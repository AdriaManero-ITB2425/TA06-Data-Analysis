<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/styles.css">
    <title>Data Analysis with Python</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header>
        <h1>Data Analysis with Python</h1>
    </header>

    <div class="container">
        <div class="section">
            <h2>Evolution of Total and Mean Precipitation Over Years</h2>
            <canvas id="totalMeanChart" width="400" height="200"></canvas>
        </div>

        <div class="section">
            <h2>Top 5 Driest and Wettest Years</h2>
            <canvas id="top5Chart" width="400" height="200"></canvas>
        </div>

        <div class="section">
            <h2>Percentage Change of Total Precipitation Over Years</h2>
            <canvas id="pctChangeChart" width="400" height="200"></canvas>
        </div>

        <div class="section data-summary">
            <h2>Data Analysis Results</h2>
            <pre id="file-content"></pre>
             <script>
        // Fetch the data.log file
        fetch('../task_03/data_analysis/data.log')
            .then(response => response.text())
            .then(data => {
                // Split the content into lines
                const lines = data.split('\n');

                // Extract lines 9 to 14 (adjust indices as JavaScript is 0-based)
                const selectedLines = lines.slice(8, 14); // Line 9 = index 8, Line 14 = index 13

                // Display the selected lines
                document.getElementById('file-content').innerText = selectedLines.join('\n');
            })
            .catch(error => {
                console.error('Error fetching data.log:', error);
            });
    </script>
            <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>Mean</th>
      <th>TotalPrecip</th>
      <th>PctChange</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2006</td>
      <td>1.419758</td>
      <td>508.293569</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2007</td>
      <td>1.082856</td>
      <td>387.670325</td>
      <td>-23.731019</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2008</td>
      <td>1.055154</td>
      <td>378.817001</td>
      <td>-2.283725</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2009</td>
      <td>1.079246</td>
      <td>386.375865</td>
      <td>1.995387</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010</td>
      <td>0.844559</td>
      <td>302.361753</td>
      <td>-21.744141</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2011</td>
      <td>1.016497</td>
      <td>363.926930</td>
      <td>20.361430</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2012</td>
      <td>1.025772</td>
      <td>368.268401</td>
      <td>1.192951</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2013</td>
      <td>1.231947</td>
      <td>441.054793</td>
      <td>19.764496</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2014</td>
      <td>1.189056</td>
      <td>425.691609</td>
      <td>-3.483283</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2015</td>
      <td>1.055901</td>
      <td>378.031692</td>
      <td>-11.195879</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2016</td>
      <td>1.287911</td>
      <td>462.373469</td>
      <td>22.310769</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2017</td>
      <td>1.039156</td>
      <td>372.029046</td>
      <td>-19.539275</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2018</td>
      <td>1.185010</td>
      <td>424.251239</td>
      <td>14.037128</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2019</td>
      <td>1.225598</td>
      <td>438.768657</td>
      <td>3.421892</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020</td>
      <td>1.162039</td>
      <td>417.185931</td>
      <td>-4.918931</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2021</td>
      <td>1.034051</td>
      <td>370.194721</td>
      <td>-11.263853</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2022</td>
      <td>1.486118</td>
      <td>532.043426</td>
      <td>43.719885</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2023</td>
      <td>0.828312</td>
      <td>296.543047</td>
      <td>-44.263376</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2024</td>
      <td>0.975224</td>
      <td>350.113396</td>
      <td>18.064949</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2025</td>
      <td>0.986927</td>
      <td>353.329264</td>
      <td>0.918522</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2026</td>
      <td>1.136828</td>
      <td>406.993762</td>
      <td>15.188240</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2027</td>
      <td>1.459039</td>
      <td>522.356798</td>
      <td>28.345161</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2028</td>
      <td>0.921688</td>
      <td>330.887973</td>
      <td>-36.654797</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2029</td>
      <td>0.982819</td>
      <td>351.867854</td>
      <td>6.340478</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2030</td>
      <td>1.301357</td>
      <td>465.891086</td>
      <td>32.405129</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2031</td>
      <td>1.288720</td>
      <td>461.371284</td>
      <td>-0.970141</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2032</td>
      <td>1.329557</td>
      <td>477.317816</td>
      <td>3.456334</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2033</td>
      <td>1.233690</td>
      <td>441.682676</td>
      <td>-7.465705</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2034</td>
      <td>0.971738</td>
      <td>347.895642</td>
      <td>-21.234030</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2035</td>
      <td>0.990849</td>
      <td>354.733640</td>
      <td>1.965531</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2036</td>
      <td>1.137699</td>
      <td>408.454905</td>
      <td>15.144113</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2037</td>
      <td>1.123444</td>
      <td>402.201980</td>
      <td>-1.530873</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2038</td>
      <td>1.013384</td>
      <td>362.798879</td>
      <td>-9.796844</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2039</td>
      <td>1.371078</td>
      <td>490.866048</td>
      <td>35.299770</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2040</td>
      <td>1.128299</td>
      <td>405.079221</td>
      <td>-17.476627</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2041</td>
      <td>0.854333</td>
      <td>305.871738</td>
      <td>-24.490884</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2042</td>
      <td>1.053349</td>
      <td>377.103891</td>
      <td>23.288243</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2043</td>
      <td>1.161417</td>
      <td>415.803393</td>
      <td>10.262292</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2044</td>
      <td>0.986305</td>
      <td>354.086709</td>
      <td>-14.842756</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2045</td>
      <td>1.017244</td>
      <td>364.173263</td>
      <td>2.848611</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2046</td>
      <td>1.110060</td>
      <td>397.418937</td>
      <td>9.129081</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2047</td>
      <td>1.104146</td>
      <td>395.284543</td>
      <td>-0.537064</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2048</td>
      <td>1.044758</td>
      <td>375.069771</td>
      <td>-5.113980</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2049</td>
      <td>1.178847</td>
      <td>422.031412</td>
      <td>12.520775</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2050</td>
      <td>1.066858</td>
      <td>381.940787</td>
      <td>-9.499441</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2051</td>
      <td>0.983130</td>
      <td>351.968663</td>
      <td>-7.847322</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2052</td>
      <td>0.870954</td>
      <td>312.672697</td>
      <td>-11.164621</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2053</td>
      <td>1.089455</td>
      <td>390.041154</td>
      <td>24.744232</td>
    </tr>
    <tr>
      <th>48</th>
      <td>2054</td>
      <td>1.314866</td>
      <td>470.735240</td>
      <td>20.688608</td>
    </tr>
    <tr>
      <th>49</th>
      <td>2055</td>
      <td>1.003735</td>
      <td>359.354986</td>
      <td>-23.660913</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2056</td>
      <td>1.327876</td>
      <td>476.709375</td>
      <td>32.656953</td>
    </tr>
    <tr>
      <th>51</th>
      <td>2057</td>
      <td>1.222361</td>
      <td>437.623867</td>
      <td>-8.199022</td>
    </tr>
    <tr>
      <th>52</th>
      <td>2058</td>
      <td>0.957234</td>
      <td>342.699875</td>
      <td>-21.690771</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2059</td>
      <td>0.843563</td>
      <td>302.006767</td>
      <td>-11.874270</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2060</td>
      <td>0.870705</td>
      <td>312.604165</td>
      <td>3.508994</td>
    </tr>
    <tr>
      <th>55</th>
      <td>2061</td>
      <td>0.921066</td>
      <td>329.748132</td>
      <td>5.484242</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2062</td>
      <td>0.956300</td>
      <td>342.356462</td>
      <td>3.823624</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2063</td>
      <td>1.063870</td>
      <td>380.872211</td>
      <td>11.250189</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2064</td>
      <td>0.889318</td>
      <td>319.276158</td>
      <td>-16.172367</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2065</td>
      <td>0.981885</td>
      <td>351.526525</td>
      <td>10.101089</td>
    </tr>
    <tr>
      <th>60</th>
      <td>2066</td>
      <td>1.047062</td>
      <td>374.860913</td>
      <td>6.638016</td>
    </tr>
    <tr>
      <th>61</th>
      <td>2067</td>
      <td>1.265500</td>
      <td>453.068121</td>
      <td>20.862994</td>
    </tr>
    <tr>
      <th>62</th>
      <td>2068</td>
      <td>0.972298</td>
      <td>349.074209</td>
      <td>-22.953262</td>
    </tr>
    <tr>
      <th>63</th>
      <td>2069</td>
      <td>0.892493</td>
      <td>319.520082</td>
      <td>-8.466431</td>
    </tr>
    <tr>
      <th>64</th>
      <td>2070</td>
      <td>1.136641</td>
      <td>406.926015</td>
      <td>27.355380</td>
    </tr>
    <tr>
      <th>65</th>
      <td>2071</td>
      <td>1.284985</td>
      <td>460.042468</td>
      <td>13.053098</td>
    </tr>
    <tr>
      <th>66</th>
      <td>2072</td>
      <td>0.865289</td>
      <td>310.651706</td>
      <td>-32.473255</td>
    </tr>
    <tr>
      <th>67</th>
      <td>2073</td>
      <td>0.973917</td>
      <td>348.668345</td>
      <td>12.237705</td>
    </tr>
    <tr>
      <th>68</th>
      <td>2074</td>
      <td>1.042268</td>
      <td>373.134331</td>
      <td>7.016979</td>
    </tr>
    <tr>
      <th>69</th>
      <td>2075</td>
      <td>1.017804</td>
      <td>364.390955</td>
      <td>-2.343225</td>
    </tr>
    <tr>
      <th>70</th>
      <td>2076</td>
      <td>0.701631</td>
      <td>251.899153</td>
      <td>-30.871184</td>
    </tr>
    <tr>
      <th>71</th>
      <td>2077</td>
      <td>0.987737</td>
      <td>353.624477</td>
      <td>40.383353</td>
    </tr>
    <tr>
      <th>72</th>
      <td>2078</td>
      <td>1.171003</td>
      <td>419.219354</td>
      <td>18.549303</td>
    </tr>
    <tr>
      <th>73</th>
      <td>2079</td>
      <td>0.636828</td>
      <td>227.994622</td>
      <td>-45.614481</td>
    </tr>
    <tr>
      <th>74</th>
      <td>2080</td>
      <td>1.066048</td>
      <td>382.717125</td>
      <td>67.862348</td>
    </tr>
    <tr>
      <th>75</th>
      <td>2081</td>
      <td>1.387077</td>
      <td>496.590046</td>
      <td>29.753809</td>
    </tr>
    <tr>
      <th>76</th>
      <td>2082</td>
      <td>0.880167</td>
      <td>315.101102</td>
      <td>-36.547036</td>
    </tr>
    <tr>
      <th>77</th>
      <td>2083</td>
      <td>1.318227</td>
      <td>471.934014</td>
      <td>49.772251</td>
    </tr>
    <tr>
      <th>78</th>
      <td>2084</td>
      <td>0.914280</td>
      <td>328.237332</td>
      <td>-30.448469</td>
    </tr>
    <tr>
      <th>79</th>
      <td>2085</td>
      <td>1.025959</td>
      <td>367.299726</td>
      <td>11.900656</td>
    </tr>
    <tr>
      <th>80</th>
      <td>2086</td>
      <td>0.822647</td>
      <td>294.525349</td>
      <td>-19.813349</td>
    </tr>
    <tr>
      <th>81</th>
      <td>2087</td>
      <td>0.777141</td>
      <td>278.218271</td>
      <td>-5.536732</td>
    </tr>
    <tr>
      <th>82</th>
      <td>2088</td>
      <td>0.813060</td>
      <td>291.902876</td>
      <td>4.918658</td>
    </tr>
    <tr>
      <th>83</th>
      <td>2089</td>
      <td>1.091073</td>
      <td>390.604457</td>
      <td>33.813158</td>
    </tr>
    <tr>
      <th>84</th>
      <td>2090</td>
      <td>1.043700</td>
      <td>373.665706</td>
      <td>-4.336548</td>
    </tr>
    <tr>
      <th>85</th>
      <td>2091</td>
      <td>0.877428</td>
      <td>314.126562</td>
      <td>-15.933799</td>
    </tr>
    <tr>
      <th>86</th>
      <td>2092</td>
      <td>1.374377</td>
      <td>493.408877</td>
      <td>57.073274</td>
    </tr>
    <tr>
      <th>87</th>
      <td>2093</td>
      <td>0.912911</td>
      <td>326.843993</td>
      <td>-33.757983</td>
    </tr>
    <tr>
      <th>88</th>
      <td>2094</td>
      <td>0.906561</td>
      <td>324.567405</td>
      <td>-0.696536</td>
    </tr>
    <tr>
      <th>89</th>
      <td>2095</td>
      <td>0.962463</td>
      <td>344.563222</td>
      <td>6.160759</td>
    </tr>
    <tr>
      <th>90</th>
      <td>2096</td>
      <td>0.681586</td>
      <td>244.703343</td>
      <td>-28.981584</td>
    </tr>
    <tr>
      <th>91</th>
      <td>2097</td>
      <td>0.689368</td>
      <td>246.813857</td>
      <td>0.862479</td>
    </tr>
    <tr>
      <th>92</th>
      <td>2098</td>
      <td>0.802540</td>
      <td>287.314150</td>
      <td>16.409246</td>
    </tr>
    <tr>
      <th>93</th>
      <td>2099</td>
      <td>1.081238</td>
      <td>387.101780</td>
      <td>34.731193</td>
    </tr>
    <tr>
      <th>94</th>
      <td>2100</td>
      <td>1.053723</td>
      <td>377.233479</td>
      <td>-2.549278</td>
    </tr>
  </tbody>
</table>
        </div>

        <div class="section">

        </div>
    </div>

    <footer class="footer">
        Estadísticas realizadas con datos extraídos de OpenData AEMET.
        1º ASIXcA Grupo 1
    </footer>

    <script>
        async function fetchData(url) {
            const response = await fetch(url);
            return response.json();
        }

        async function renderCharts() {
            const meanResults = await fetchData('mean_results.json');
            const top5Driest = await fetchData('top_5_driest.json');
            const top5Wettest = await fetchData('top_5_wettest.json');

            // Total and Mean Precipitation Over Years
            const totalMeanCtx = document.getElementById('totalMeanChart').getContext('2d');
            new Chart(totalMeanCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(meanResults.TotalPrecip),
                    datasets: [
                        {
                            label: 'Total Precipitation',
                            data: Object.values(meanResults.TotalPrecip),
                            backgroundColor: 'blue'
                        },
                        {
                            label: 'Mean Precipitation',
                            data: Object.values(meanResults.Mean),
                            backgroundColor: 'green'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: { title: { display: true, text: 'Year' } },
                        y: { title: { display: true, text: 'Precipitation (l/m²)' } }
                    }
                }
            });

            // Top 5 Driest and Wettest Years
            const top5Ctx = document.getElementById('top5Chart').getContext('2d');
            const top5Years = [...Object.keys(top5Driest.TotalPrecip), ...Object.keys(top5Wettest.TotalPrecip)];
            const top5Values = [...Object.values(top5Driest.TotalPrecip), ...Object.values(top5Wettest.TotalPrecip)];
            const top5Colors = Array(Object.keys(top5Driest.TotalPrecip).length).fill('brown').concat(
                Array(Object.keys(top5Wettest.TotalPrecip).length).fill('blue')
            );
            new Chart(top5Ctx, {
                type: 'bar',
                data: {
                    labels: top5Years,
                    datasets: [{
                        label: 'Total Precipitation',
                        data: top5Values,
                        backgroundColor: top5Colors
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: { title: { display: true, text: 'Year' } },
                        y: { title: { display: true, text: 'Total Precipitation (l/m²)' } }
                    }
                }
            });

            // Percentage Change of Total Precipitation Over Years
            const pctChangeCtx = document.getElementById('pctChangeChart').getContext('2d');
            new Chart(pctChangeCtx, {
                type: 'line',
                data: {
                    labels: Object.keys(meanResults.PctChange),
                    datasets: [{
                        label: 'Percentage Change',
                        data: Object.values(meanResults.PctChange),
                        borderColor: 'red',
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: { title: { display: true, text: 'Year' } },
                        y: { title: { display: true, text: 'Percentage Change (%)' } }
                    }
                }
            });
        }

        renderCharts();
    </script>
</body>
</html>
